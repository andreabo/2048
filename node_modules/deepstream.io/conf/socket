const deepstream = require('deepstream.io-client-js')

function connect(whenReadyFunc) {
  const client = deepstream('ws://0.0.0.0:6020/deepstream');
  client.login().then(() => {
    whenReadyFunc(client);
  }).catch((err) => {
    console.log('error', err)
  });
}

function createRecord(client) {
  const path = 'testrecord';
  const record = client.record.getRecord(path);
  console.log('update ' + path + '/someflag to true');
  record.set('someFlag', true, () => {
    console.log('record updated:', path, record.get('someFlag'));
  });
}

//open connections for each user
connect(createRecord);
